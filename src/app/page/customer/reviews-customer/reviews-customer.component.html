<div class="container mt-4 p-5">
  <h1 class="text-lg-start mb-4">Rating & Reviews</h1>

  <!-- Loop through reviews -->
  <div class="card mb-4" *ngFor="let review of reviews">
    <div class="card-body">
      <h3 class="card-title">{{ review.name }}</h3>
      <p class="card-text text-muted">{{ review.date }}</p>

      <!-- Star Rating Display -->
      <div class="rating">
        <span
          *ngFor="let star of [1, 2, 3, 4, 5]; let i = index"
          [class.filled]="i < review.rating"
        >
          &#9733;
        </span>
        <span class="rating-value">{{ review.rating }}.0</span>
      </div>

      <p class="card-text">{{ review.comment }}</p>

      <button class="m-2" (click)="openPopup(review)">Edit</button>
      <button class="delete-btn" (click)="deleteReview(review.id)">
        Delete
      </button>
    </div>
  </div>

  <!-- Edit Popup -->
  <div class="popup-overlay" *ngIf="isPopupOpen">
    <div class="popup">
      <h3>Edit Comment</h3>

      <!-- Editable Star Rating -->
      <div class="rating">
        <span
          *ngFor="let star of [1, 2, 3, 4, 5]; let i = index"
          (click)="editedReview.rating = i + 1"
          [class.filled]="i < editedReview.rating"
        >
          &#9733;
        </span>
        <span class="rating-value">{{ editedReview.rating }}.0</span>
      </div>

      <textarea [(ngModel)]="editedReview.comment"></textarea>
      <div class="popup-buttons">
        <button (click)="saveComment()">Save</button>
        <button (click)="closePopup()">Cancel</button>
      </div>
    </div>
  </div>
</div>
